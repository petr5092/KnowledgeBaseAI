import asyncio
import sys
import os

# Ensure we can import app
sys.path.append(os.getcwd())

from app.services.curriculum.builder import generate_curriculum_llm

fipi_profile_2026 = """
СТРУКТУРА ЕГЭ 2026 (ПРОФИЛЬНАЯ МАТЕМАТИКА) - 19 ЗАДАНИЙ:

Часть 1 (Краткий ответ):
1. Планиметрия (Треугольники, четырехугольники, окружности)
2. Векторы (Координаты, операции с векторами, скалярное произведение)
3. Стереометрия (Куб, призма, пирамида, конус, цилиндр, шар)
4. Теория вероятностей (Классическое определение, простые события)
5. Теория вероятностей (Теоремы о вероятностях, сложные события)
6. Простейшие уравнения (Показательные, логарифмические, тригонометрические, иррациональные)
7. Вычисления и преобразования (Степени, корни, логарифмы, тригонометрия)
8. Производная и первообразная (Геометрический смысл, касательная, график производной)
9. Задачи с прикладным содержанием (Расчеты по формулам)
10. Текстовая задача (Движение, работа, сплавы/смеси, прогрессии)
11. Графики функций (Линейная, квадратичная, дробно-рациональная, показательная, логарифмическая, тригонометрическая)
12. Исследование функций (Точки экстремума, наибольшее/наименьшее значение)

Часть 2 (Развернутый ответ):
13. Уравнения (Смешанные, тригонометрические, отбор корней)
14. Стереометрия (Построение сечений, доказательство, вычисление углов и расстояний)
15. Неравенства (Показательные, логарифмические, метод рационализации)
16. Экономическая задача (Кредиты, вклады, оптимизация)
17. Планиметрия (Доказательство свойств, вычисление элементов)
18. Задачи с параметром (Графический и аналитический методы)
19. Числа и их свойства (Делимость, оценка и пример, олимпиадная задача)
"""

fipi_basic_2026 = """
СТРУКТУРА ЕГЭ 2026 (БАЗОВАЯ МАТЕМАТИКА) - 21 ЗАДАНИЕ:
1. Вычисления и преобразования
2. Текстовые задачи (проценты, пропорции)
3. Геометрия (планиметрия, нахождение длин и площадей)
4. Работа с формулами
5. Простейшие уравнения
6. Геометрия (планиметрия, углы)
7. Работа с графиками и диаграммами
8. Текстовые задачи (жизненные ситуации)
9. Теория вероятностей
10. Размеры и единицы измерения
11. Стереометрия (составные фигуры)
12. Геометрия (стереометрия, объемы и площади)
13. Стереометрия (вращение фигур)
14. Анализ графиков и таблиц
15. Планиметрия (сложные фигуры)
16. Стереометрия (цилиндр, конус, шар)
17. Неравенства
18. Логические задачи (выбор утверждений)
19. Числа и их свойства (делимость)
20. Текстовые задачи на смекалку
21. Задачи на логику и построение примеров
"""

async def main():
    tasks = [
        {
            "goal": f"Подготовка к ЕГЭ по математике (Профильный уровень) 2026. Учесть все 19 заданий.\n{fipi_profile_2026}",
            "audience": "Ученики 11 класса, поступающие в технические вузы",
            "subject_uids": ["MATH-FULL-V1"],
            "language": "ru"
        },
        {
            "goal": f"Подготовка к ЕГЭ по математике (Базовый уровень) 2026. Учесть все 21 задание.\n{fipi_basic_2026}",
            "audience": "Ученики 11 класса, гуманитарный профиль",
            "subject_uids": ["MATH-FULL-V1"],
            "language": "ru"
        }
    ]

    print("Starting curriculum generation...")
    for task in tasks:
        print(f"\nGenerating for goal: {task['goal'].splitlines()[0]}...")
        res = await generate_curriculum_llm(
            goal=task["goal"],
            audience=task["audience"],
            subject_uids=task["subject_uids"],
            language=task["language"]
        )
        if res.get("ok"):
            print(f"SUCCESS: Created curriculum {res.get('code')} - {res.get('title')}")
            print(f"Items count: {res.get('items_count')}")
        else:
            print(f"FAILED: {res.get('error')}")

if __name__ == "__main__":
    asyncio.run(main())
